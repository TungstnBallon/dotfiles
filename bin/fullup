#!/usr/bin/env bash

first=true

function section() {
	if [ $first = true ]; then
		first=false
		printf "\e[2m---* %s *---\e[0m\n" "$1"
	else
		printf "\n\e[2m---* %s *---\e[0m\n" "$1"
	fi
}

section "System & AUR packages"
paru -Syu --noconfirm
if [ -f /tmp/NVIM_COMMIT ]; then
	xdg-open "https://github.com/neovim/neovim/compare/$(cat /tmp/NVIM_COMMIT)...HEAD"
	sudo rm /tmp/NVIM_COMMIT
fi

section Flatpak
flatpak update -y
flatpak remove --unused -y
flatpak remove --delete-data -y

section Rust
rustup update

section Dotfiles
git -C "$HOME/.dotfiles" pull

section Prompt
(
	cd "$HOME/.dotfiles/terminal/prompt" || return
	cargo install --path .
)
